# Packages ç›®å½•ç»“æ„è¯´æ˜

æœ¬ç›®å½•åŒ…å« Monorepo ä¸­çš„æ‰€æœ‰å­åŒ…ï¼ˆpackagesï¼‰ã€‚æ¯ä¸ªåŒ…éƒ½æ˜¯ç‹¬ç«‹çš„ npm æ¨¡å—ï¼Œå¯ä»¥å•ç‹¬å‘å¸ƒå’Œä½¿ç”¨ã€‚

## ğŸ“ ç›®å½•æ ‘å½¢ç»“æ„

```
packages/
â”œâ”€â”€ base-ui/                          # åŸºç¡€ UI ç»„ä»¶åº“
â”‚   â”œâ”€â”€ package.json                  # åŒ…é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ Button/                   # Button ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ index.tsx             # ç»„ä»¶å®ç°
â”‚       â”‚   â””â”€â”€ index.md              # ç»„ä»¶æ–‡æ¡£
â”‚       â”œâ”€â”€ Input/                    # Input ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ index.tsx             # ç»„ä»¶å®ç°
â”‚       â”‚   â””â”€â”€ index.md              # ç»„ä»¶æ–‡æ¡£
â”‚       â”œâ”€â”€ Select/                   # Select ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ index.tsx             # ç»„ä»¶å®ç°
â”‚       â”‚   â””â”€â”€ index.md              # ç»„ä»¶æ–‡æ¡£
â”‚       â””â”€â”€ index.ts                  # åŒ…å¯¼å‡ºå…¥å£
â”‚
â”œâ”€â”€ base-form/                        # åŸºç¡€è¡¨å•ç»„ä»¶åº“
â”‚   â”œâ”€â”€ package.json                  # åŒ…é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ src/                          # æºç ç›®å½•ï¼ˆå¾…æ‰©å±•ï¼‰
â”‚
â”œâ”€â”€ business-admin/                   # ç®¡ç†åå°ç»„ä»¶åº“
â”‚   â”œâ”€â”€ package.json                  # åŒ…é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ src/                          # æºç ç›®å½•
â”‚   â””â”€â”€ docs/                         # æ–‡æ¡£ç›®å½•
â”‚
â”œâ”€â”€ business-dashboard/               # æ•°æ®å¤§å±ç»„ä»¶åº“
â”‚   â”œâ”€â”€ package.json                  # åŒ…é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ src/                          # æºç ç›®å½•
â”‚   â””â”€â”€ docs/                         # æ–‡æ¡£ç›®å½•
â”‚
â””â”€â”€ shared/                           # å…±äº«åº“ï¼ˆå·¥å…·ã€å¸¸é‡ç­‰ï¼‰
    â”œâ”€â”€ package.json                  # åŒ…é…ç½®æ–‡ä»¶
    â””â”€â”€ src/                          # æºç ç›®å½•
```

---

## ğŸ“¦ å„åŒ…è¯¦ç»†è¯´æ˜

### 1. **base-ui** - åŸºç¡€ UI ç»„ä»¶åº“

**ç”¨é€”ï¼š** æä¾›é€šç”¨çš„åŸºç¡€ UI ç»„ä»¶

**åŒ…å«ç»„ä»¶ï¼š**
- `Button` - æŒ‰é’®ç»„ä»¶
- `Input` - è¾“å…¥æ¡†ç»„ä»¶
- `Select` - é€‰æ‹©æ¡†ç»„ä»¶

**æ–‡ä»¶ç»“æ„ï¼š**
```
base-ui/
â”œâ”€â”€ package.json
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ Button/
â”‚   â”‚   â”œâ”€â”€ index.tsx        # ç»„ä»¶å®ç°
â”‚   â”‚   â””â”€â”€ index.md         # ç»„ä»¶æ–‡æ¡£å’Œä½¿ç”¨ç¤ºä¾‹
â”‚   â”œâ”€â”€ Input/
â”‚   â”‚   â”œâ”€â”€ index.tsx        # ç»„ä»¶å®ç°
â”‚   â”‚   â””â”€â”€ index.md         # ç»„ä»¶æ–‡æ¡£å’Œä½¿ç”¨ç¤ºä¾‹
â”‚   â”œâ”€â”€ Select/
â”‚   â”‚   â”œâ”€â”€ index.tsx        # ç»„ä»¶å®ç°
â”‚   â”‚   â””â”€â”€ index.md         # ç»„ä»¶æ–‡æ¡£å’Œä½¿ç”¨ç¤ºä¾‹
â”‚   â””â”€â”€ index.ts             # åŒ…å¯¼å‡ºï¼šexport { Button, Input, Select }
â””â”€â”€ .dumi/                   # Dumi ä¸´æ—¶æ–‡ä»¶ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
```

**æ–‡æ¡£è·¯ç”±ï¼š**
- `/components/button` - Button ç»„ä»¶æ–‡æ¡£
- `/components/input` - Input ç»„ä»¶æ–‡æ¡£
- `/components/select` - Select ç»„ä»¶æ–‡æ¡£

**ä½¿ç”¨æ–¹å¼ï¼š**
```tsx
import { Button, Input, Select } from '@regan-ad/base-ui';
```

---

### 2. **base-form** - åŸºç¡€è¡¨å•ç»„ä»¶åº“

**ç”¨é€”ï¼š** æä¾›è¡¨å•ç›¸å…³çš„ç»„ä»¶å’Œå·¥å…·

**çŠ¶æ€ï¼š** ğŸš§ å¼€å‘ä¸­ï¼ˆç›®å‰ä»…æœ‰åŒ…ç»“æ„ï¼Œå¾…æ·»åŠ ç»„ä»¶ï¼‰

**æ–‡ä»¶ç»“æ„ï¼š**
```
base-form/
â”œâ”€â”€ package.json
â””â”€â”€ src/                     # å¾…æ·»åŠ ç»„ä»¶
```

**åç»­è®¡åˆ’ï¼š**
- [ ] æ·»åŠ  Form ç»„ä»¶
- [ ] æ·»åŠ  FormItem ç»„ä»¶
- [ ] æ·»åŠ å­—æ®µéªŒè¯å·¥å…·

---

### 3. **business-admin** - ç®¡ç†åå°ç»„ä»¶åº“

**ç”¨é€”ï¼š** æä¾›åå°ç®¡ç†ç³»ç»Ÿä¸“ç”¨çš„ç»„ä»¶

**æ–‡ä»¶ç»“æ„ï¼š**
```
business-admin/
â”œâ”€â”€ package.json
â”œâ”€â”€ src/                     # æºç ï¼ˆè‡ªå®šä¹‰å¸ƒå±€ã€è¡¨å•ç­‰ï¼‰
â””â”€â”€ docs/                    # æ–‡æ¡£ç›®å½•
```

**ç‰¹ç‚¹ï¼š**
- ä¸“æ³¨äºåå°ç®¡ç†ç•Œé¢
- é›†æˆæƒé™ã€èœå•ç­‰ç®¡ç†åŠŸèƒ½
- åŒ…å«æ•°æ®è¡¨æ ¼ã€è¡¨å•ç­‰å¤æ‚ç»„ä»¶

---

### 4. **business-dashboard** - æ•°æ®å¤§å±ç»„ä»¶åº“

**ç”¨é€”ï¼š** æä¾›æ•°æ®å¯è§†åŒ–å’Œå¤§å±ç›¸å…³çš„ç»„ä»¶

**æ–‡ä»¶ç»“æ„ï¼š**
```
business-dashboard/
â”œâ”€â”€ package.json
â”œâ”€â”€ src/                     # æºç ï¼ˆå›¾è¡¨ã€å¤§å±ç»„ä»¶ç­‰ï¼‰
â””â”€â”€ docs/                    # æ–‡æ¡£ç›®å½•
```

**ç‰¹ç‚¹ï¼š**
- ä¸“æ³¨äºæ•°æ®å¯è§†åŒ–
- åŒ…å«å›¾è¡¨ã€åœ°å›¾ç­‰ç»„ä»¶
- æ”¯æŒå¤§å±é€‚é…å’Œå®æ—¶æ•°æ®å±•ç¤º

---

### 5. **shared** - å…±äº«åº“

**ç”¨é€”ï¼š** å­˜æ”¾æ‰€æœ‰åŒ…éƒ½éœ€è¦ä½¿ç”¨çš„å…¬å…±ä»£ç 

**åŒ…å«å†…å®¹ï¼š**
- å…¬å…±ç±»å‹å®šä¹‰ (`types/`)
- å·¥å…·å‡½æ•° (`utils/`)
- å¸¸é‡ (`constants/`)
- æ ·å¼å˜é‡ (`styles/`)

**æ–‡ä»¶ç»“æ„ï¼š**
```
shared/
â”œâ”€â”€ package.json
â””â”€â”€ src/
    â”œâ”€â”€ types/               # TypeScript ç±»å‹å®šä¹‰
    â”œâ”€â”€ utils/               # å·¥å…·å‡½æ•°
    â”œâ”€â”€ constants/           # å¸¸é‡
    â””â”€â”€ styles/              # æ ·å¼å˜é‡
```

**ä½¿ç”¨æ–¹å¼ï¼š**
```tsx
import { someUtil } from '@regan-ad/shared';
```

---

## ğŸš€ æ–‡æ¡£ç»“æ„è¯´æ˜

### ç»„ä»¶æ–‡æ¡£ï¼ˆ`src/Component/index.md`ï¼‰

æ¯ä¸ªç»„ä»¶éƒ½æœ‰ä¸€ä¸ª `index.md` æ–‡æ¡£æ–‡ä»¶ï¼ŒåŒ…å«ï¼š

```markdown
---
title: Component åç§°
group:
  title: Base UI          # åˆ†ç»„åç§°
  order: 1                # æ’åº
---

# Component åç§°

ç»„ä»¶æè¿°

## åŸºç¡€ç”¨æ³•

\`\`\`tsx
import { Component } from '@regan-ad/base-ui';

export default () => <Component />;
\`\`\`

## Props

| å±æ€§ | ç±»å‹ | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|------|--------|
| ... | ... | ... | ... |

## ç¤ºä¾‹

### ç¤ºä¾‹ 1

\`\`\`tsx
// ä»£ç ç¤ºä¾‹
\`\`\`

### ç¤ºä¾‹ 2

\`\`\`tsx
// ä»£ç ç¤ºä¾‹
\`\`\`
```

**å…³é”®ç‚¹ï¼š**
- `group.title` å¿…é¡»ä¸€è‡´ï¼Œæ‰èƒ½åœ¨ Dumi èœå•ä¸­æ˜¾ç¤ºä¸ºä¸€ä¸ªåˆ†ç»„
- `order` æ§åˆ¶ç»„ä»¶åœ¨åˆ†ç»„å†…çš„æ˜¾ç¤ºé¡ºåº
- Markdown ä¸­çš„ TSX ä»£ç å—ä¼šè‡ªåŠ¨å˜æˆå¯æ‰§è¡Œçš„ Demo

---

## ğŸ“– æ–‡æ¡£è®¿é—®æ–¹å¼

æ‰€æœ‰åŒ…çš„æ–‡æ¡£éƒ½é›†ä¸­åœ¨ç»Ÿä¸€çš„æ–‡æ¡£ç«™ç‚¹ä¸­ï¼š

```
http://localhost:8000/

å¯¼èˆªèœå•ï¼š
â”œâ”€ é¦–é¡µ
â”œâ”€ æŒ‡å—
â”œâ”€ ç»„ä»¶
â”‚  â”œâ”€ Base UI
â”‚  â”‚  â”œâ”€ Base UI ç»„ä»¶åº“
â”‚  â”‚  â”œâ”€ Button ç»„ä»¶
â”‚  â”‚  â”œâ”€ Input ç»„ä»¶
â”‚  â”‚  â””â”€ Select ç»„ä»¶
â”‚  â”œâ”€ Base Form
â”‚  â”œâ”€ Business Admin
â”‚  â””â”€ Business Dashboard
â””â”€ GitHub
```

---

## ğŸ”„ å¦‚ä½•æ·»åŠ æ–°åŒ…

### æ­¥éª¤ 1ï¼šåˆ›å»ºåŒ…ç›®å½•

```bash
mkdir -p packages/my-package/src
cd packages/my-package
```

### æ­¥éª¤ 2ï¼šåˆ›å»º `package.json`

```json
{
  "name": "@regan-ad/my-package",
  "version": "1.0.0",
  "description": "æˆ‘çš„åŒ…æè¿°",
  "main": "dist/index.js",
  "types": "dist/index.d.ts",
  "files": ["dist"],
  "scripts": {
    "build": "tsc",
    "build:watch": "tsc -w"
  },
  "dependencies": {
    "@regan-ad/shared": "workspace:*"
  },
  "devDependencies": {
    "typescript": "^5.0.0"
  }
}
```

### æ­¥éª¤ 3ï¼šåˆ›å»ºç»„ä»¶å¹¶æ·»åŠ æ–‡æ¡£

```bash
mkdir -p src/MyComponent
```

åˆ›å»º `src/MyComponent/index.tsx`ï¼š

```tsx
export interface MyComponentProps {
  title?: string;
}

export const MyComponent: React.FC<MyComponentProps> = ({ title }) => {
  return <div>{title}</div>;
};
```

åˆ›å»º `src/MyComponent/index.md`ï¼š

```markdown
---
title: My Component ç»„ä»¶
group:
  title: My Package
  order: 1
---

# My Component ç»„ä»¶

...
```

### æ­¥éª¤ 4ï¼šæ›´æ–° `docs/.dumirc.ts`

åœ¨ `resolve.atomDirs` ä¸­æ·»åŠ æ–°åŒ…ï¼š

```typescript
atomDirs: [
  // ... å…¶ä»–åŒ…
  {
    type: 'component',
    dir: '../packages/my-package/src',
  },
],
```

### æ­¥éª¤ 5ï¼šæ›´æ–°æ ¹ `pnpm-workspace.yaml`

```yaml
packages:
  - 'packages/*'
  - 'docs'
```

---

## ğŸ“ å¼€å‘è§„èŒƒ

### ç»„ä»¶å¼€å‘è§„èŒƒ

1. **æ–‡ä»¶ç»“æ„**
   ```
   src/ComponentName/
   â”œâ”€â”€ index.tsx          # ç»„ä»¶å®ç°
   â”œâ”€â”€ index.md           # ç»„ä»¶æ–‡æ¡£
   â”œâ”€â”€ style.css          # æ ·å¼æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
   â””â”€â”€ __tests__/         # æµ‹è¯•æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰
   ```

2. **å‘½åè§„èŒƒ**
   - ç»„ä»¶åé‡‡ç”¨ PascalCaseï¼ˆå¦‚ `Button`, `InputField`ï¼‰
   - ç›®å½•åé‡‡ç”¨ PascalCaseï¼ˆä¸ç»„ä»¶åä¸€è‡´ï¼‰
   - æ–‡ä»¶åä¸º `index.tsx` æˆ– `index.ts`

3. **å¯¼å‡ºè§„èŒƒ**
   - åœ¨ `src/index.ts` ä¸­å¯¼å‡ºæ‰€æœ‰å…¬å¼€ç»„ä»¶
   ```tsx
   export { Button } from './Button';
   export { Input } from './Input';
   export { Select } from './Select';
   ```

4. **æ–‡æ¡£è§„èŒƒ**
   - æ¯ä¸ªç»„ä»¶å¿…é¡»æœ‰ `index.md` æ–‡æ¡£
   - æ–‡æ¡£è¦åŒ…å«ä½¿ç”¨ç¤ºä¾‹å’Œ API æ–‡æ¡£
   - ç¤ºä¾‹ä»£ç å¿…é¡»æ˜¯å¯æ‰§è¡Œçš„ TSX ä»£ç 

---

## ğŸ”— ä¾èµ–å…³ç³»

```
business-admin â”€â”€â”
                 â”œâ”€â”€> base-ui â”€â”€â”
business-dashboardâ”€â”˜            â”œâ”€â”€> shared
                    base-form â”€â”€â”˜
```

**ä¾èµ–è¯´æ˜ï¼š**
- æ‰€æœ‰åŒ…éƒ½å¯ä»¥ä¾èµ– `@regan-ad/shared`
- `base-ui` æ˜¯åŸºç¡€åŒ…ï¼Œä¸ä¾èµ–å…¶ä»–ä¸šåŠ¡åŒ…
- ä¸šåŠ¡åŒ…å¯ä»¥ä¾èµ–åŸºç¡€åŒ…ï¼Œä½†åŸºç¡€åŒ…ä¸èƒ½ä¾èµ–ä¸šåŠ¡åŒ…

---

## ğŸ“¦ æ‰“åŒ…å’Œå‘å¸ƒ

### æ‰“åŒ…æ‰€æœ‰åŒ…

```bash
pnpm build
```

### å‘å¸ƒåˆ° npm

```bash
# éœ€è¦é…ç½® npm registry å’Œæƒé™
pnpm -r publish
```

---

## ğŸ†˜ å¸¸è§é—®é¢˜

### Q: å¦‚ä½•åœ¨å…¶ä»–åŒ…ä¸­ä½¿ç”¨æŸä¸ªåŒ…ï¼Ÿ

**A:** åœ¨ `package.json` ä¸­æ·»åŠ ä¾èµ–ï¼š

```json
{
  "dependencies": {
    "@regan-ad/base-ui": "workspace:*"
  }
}
```

ç„¶åå¯¼å…¥ä½¿ç”¨ï¼š

```tsx
import { Button } from '@regan-ad/base-ui';
```

### Q: ç»„ä»¶æ–‡æ¡£ä¸ºä»€ä¹ˆæ²¡æœ‰æ˜¾ç¤ºï¼Ÿ

**A:** æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š

1. âœ… æ–‡ä»¶æ˜¯å¦å‘½åä¸º `index.md`
2. âœ… Frontmatter ä¸­çš„ `group.title` æ˜¯å¦æ­£ç¡®
3. âœ… `.dumirc.ts` ä¸­æ˜¯å¦é…ç½®äº† `atomDirs`
4. âœ… æ˜¯å¦æ¸…ç©ºäº†ç¼“å­˜ï¼ˆ`rm -rf .dumi docs/.dumi`ï¼‰

### Q: å¦‚ä½•æœ¬åœ°å¼€å‘å’Œæµ‹è¯•ï¼Ÿ

**A:**

```bash
# å¯åŠ¨æ–‡æ¡£å¼€å‘æœåŠ¡å™¨
pnpm docs:dev

# åœ¨å¦ä¸€ä¸ªç»ˆç«¯å¯åŠ¨ç»„ä»¶å¼€å‘
pnpm --filter @regan-ad/base-ui build:watch

# æµè§ˆå™¨è®¿é—® http://localhost:8000
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Dumi å®˜æ–¹æ–‡æ¡£](https://d.umijs.org)
- [Umi æ¡†æ¶æ–‡æ¡£](https://umijs.org)
- [pnpm Monorepo æ–‡æ¡£](https://pnpm.io)
- [TypeScript å®˜æ–¹æ–‡æ¡£](https://www.typescriptlang.org)

---

**æœ€åæ›´æ–°ï¼š** 2024å¹´11æœˆ
**ç»´æŠ¤è€…ï¼š** Regan AD å›¢é˜Ÿ
